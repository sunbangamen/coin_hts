# Issue #6: End-to-End 통합 테스트 및 파일 구조 점검

## 1. 이슈 정보 요약

**번호**: #6
**제목**: [Phase 1] Task 6: End-to-End 통합 테스트 및 파일 구조 점검
**상태**: OPEN
**생성일**: 2025-10-31
**라벨**: Phase-1, testing, integration, e2e
**예상 시간**: 4시간

**핵심 요구사항**:
전체 파이프라인 검증 - Frontend 입력 → Backend 실행 → 파일 저장 → UI 표시까지 모든 단계가 정상 작동하는지 확인. Phase 2 확장 가능성 점검 및 Phase 1 완료 보고서 작성.

**의존성**:
- Task 1~5 모두 완료 필수 ✅ (모두 완료됨)

---

## 2. 문제 이해

### 현재 상태
- **Phase 1 완료 직전**: Tasks 1~5가 모두 완료된 상태
  - ✅ Task 1: 백엔드 데이터 로더 구현
  - ✅ Task 2: 백테스트 전략 엔진 구현
  - ✅ Task 3: FastAPI 엔드포인트 실제 로직 연결
  - ✅ Task 4: React 폼 유효성 검사
  - ✅ Task 5: React 결과 테이블 및 차트 컴포넌트 구현 (6/8 steps)

- **테스트 데이터**: BTC_KRW, ETH_KRW OHLCV parquet 파일 준비됨 (60일, 2024-01-01 ~ 2024-02-29)
- **전략**: `volume_long_candle`, `volume_zone_breakout` 2가지 구현 완료
- **Docker 환경**: docker-compose.yml 설정 완료

### 필요한 전제 조건
1. ✅ Docker Compose 환경 실행 가능
2. ✅ 테스트 데이터 준비 완료 (BTC_KRW, ETH_KRW)
3. ✅ 2가지 전략 구현 완료
 4. ✅ 결과 파일 저장 로직 구현 완료 (`DATA_ROOT/results/{run_id}.json`)
 5. ⏳ 로그 수집 설정 확인 필요 (현재 콘솔 로그 중심)

### 불확실성 및 위험 요소
- 결과 파일 저장 경로가 설정되어 있는지 확인 필요
- 로그 수집 메커니즘이 구현되어 있는지 확인 필요
- Phase 2 전환 조건이 모호할 경우 명확화 필요
- 연속 실행 시 메모리 누수 가능성

---

## 3. 해결 계획

### Step 1: 환경 및 현재 상태 검증
**작업 설명**:
- Docker Compose 환경 실행 확인
- 테스트 데이터 존재 여부 확인 (BTC_KRW, ETH_KRW parquet)
- 결과 저장 디렉토리 구조 확인 (`data/results/`)
- 백엔드 로그 메커니즘 확인 (run_id 태깅, 실행 흐름 추적)
- 현재 코드에서 결과 파일 저장 로직 검토

**예상 산출물**:
- 환경 상태 체크리스트
- 결과 파일 저장 로직 확인 (구현 여부)
- 로그 수집 메커니즘 확인 (구현 여부)

**의존성**: 없음

**확인 방법**:
- `docker-compose up` 실행 성공
- `/data/BTC_KRW/1D/2024.parquet`, `/data/ETH_KRW/1D/2024.parquet` 존재 확인
- Backend 코드에서 결과 파일 저장 로직 검토 (main.py)

---

### Step 2: 기본 E2E 테스트 시나리오 실행 (4가지)
**작업 설명**:
- **시나리오 1**: `volume_long_candle` + BTC_KRW (단일 심볼)
- **시나리오 2**: `volume_long_candle` + BTC_KRW, ETH_KRW (다중 심볼)
- **시나리오 3**: `volume_zone_breakout` + BTC_KRW (단일 심볼)
- **시나리오 4**: `volume_zone_breakout` + BTC_KRW, ETH_KRW (다중 심볼)

각 시나리오마다:
1. Frontend에서 파라미터 입력 (또는 API 직접 호출)
2. Backend 실행 및 로그 확인
3. 결과 파일 생성 확인 (`data/results/{run_id}.json`)
4. Frontend UI에서 결과 표시 확인 (지표, 신호 목록)

**예상 산출물**:
- 4가지 시나리오별 실행 결과 로그
- 생성된 결과 파일 (`{run_id}.json`) 4개
- UI 스크린샷 또는 확인 로그

**의존성**: Step 1 완료

**확인 방법**:
- 각 시나리오별 API 응답 200 OK
- 결과 파일 존재 및 내용 검증 (JSON 구조 확인)
- Frontend에서 지표 및 신호 목록 정상 표시

---

### Step 3: 결과 파일 및 로그 구조 점검
**작업 설명**:
  - 결과 JSON 스키마 검토
    - 핵심 필드 존재 여부 (`run_id`, `strategy`, `symbols`, `total_signals`, `execution_time`)
    - Phase 2 확장을 위한 메타데이터 필드 추가 여지(예: `version`, 실행 환경) 검토
  - 로그 구조 검토
    - `run_id` 기반 콘솔 로그 태깅 여부
    - 실행 흐름 추적 가능 여부 (데이터 로드 → 전략 실행 → 결과 저장)

**예상 산출물**:
- 결과 JSON 스키마 평가 보고서
- 로그 구조 평가 보고서
- Phase 2 확장을 위한 개선 제안 사항

**의존성**: Step 2 완료

**확인 방법**:
- JSON 스키마 필드 체크리스트 작성
- 로그 메시지 샘플 수집 및 분석

---

### Step 4: 성능 및 안정성 검증
**작업 설명**:
- 연속 10회 실행 테스트 (동일 또는 다른 전략/심볼 조합)
- 메모리 누수 확인 (Docker 컨테이너 리소스 모니터링)
- 실행 시간 측정
  - 데이터 로드 시간
  - 전략 실행 시간
  - 결과 저장 시간
  - 전체 실행 시간

**예상 산출물**:
- 10회 실행 성공률 (목표: 100%)
- 메모리 사용량 추이 그래프 또는 로그
- 실행 시간 통계 (평균, 최소, 최대)

**의존성**: Step 2-3 완료

**확인 방법**:
- 10회 실행 모두 200 OK 응답
- Docker stats 명령으로 메모리 사용량 모니터링
- Backend 로그에서 실행 시간 추출

---

### Step 5: Phase 1 완료 보고서 작성
**작업 설명**:
- `docs/coin/mvp/phase1_test_report.md` 작성
  - 테스트 결과 요약 (4가지 시나리오 + 10회 연속 실행)
  - 발견된 이슈 및 해결 방안
  - Phase 2 전환 조건 충족 여부 체크리스트
  - 개선 제안 사항

**Phase 2 전환 조건**:
1. 2가지 전략 모두 실제 데이터로 백테스트 실행 성공
2. UI에서 지표 및 신호 목록이 정상 표시됨
3. 결과 JSON 스키마가 심볼별 상세 정보 및 확장 메타데이터를 추가하기 쉬운 구조인지 평가됨
4. Docker Compose 환경에서 오류 없이 10회 이상 연속 실행 성공
5. 콘솔 로그에서 run_id 기반 실행 흐름을 추적할 수 있음 (필요 시 파일 로그 전환 방안 제시)
6. Phase 1 완료 보고서 작성 및 팀 리뷰 완료

**예상 산출물**:
- `docs/coin/mvp/phase1_test_report.md`
- Phase 2 전환 조건 충족 여부 명시
- 개선 제안 사항 목록

**의존성**: Step 1-4 완료

**확인 방법**:
- 보고서 작성 완료
- 6가지 전환 조건 모두 충족 확인

---

## 4. 사용자 확인 요청

위 계획을 검토해주세요. 다음 사항을 확인 부탁드립니다:

1. **결과 파일 저장 로직**: 현재 Backend에서 `data/results/{run_id}.json` 파일을 저장하는 로직이 구현되어 있나요? 아니면 이번 Task에서 추가 구현이 필요한가요?

2. **로그 수집**: `run_id` 기반 로그 태깅이나 실행 흐름 추적 로그가 현재 구현되어 있나요? 아니면 추가 구현이 필요한가요?

3. **테스트 방법**: Frontend UI를 통한 수동 테스트를 선호하시나요, 아니면 API 직접 호출(curl/Python script)로 자동화된 테스트를 선호하시나요?

4. **Phase 2 전환 기준**: 위에 명시된 6가지 전환 조건이 적절한가요? 추가하거나 수정할 조건이 있나요?

위 계획대로 진행해도 괜찮으시다면 바로 시작하겠습니다! 추가 정보가 필요하거나 계획 수정이 필요하시면 말씀해주세요.
