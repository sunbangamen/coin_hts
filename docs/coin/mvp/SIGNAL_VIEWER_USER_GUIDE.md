# 시그널 뷰어 사용 가이드 (Phase 2)

## 개요

시그널 뷰어는 백테스트 결과를 조회하고 심볼별 활성/비활성을 동적으로 관리할 수 있는 도구입니다.
사용자는 개별 심볼의 토글을 통해 성과 분석에 포함할 심볼을 선택적으로 제어할 수 있습니다.

**버전**: 1.0.0 (Phase 2)
**마지막 업데이트**: 2025-11-11

---

## 시작하기

### 1단계: 시그널 뷰어 페이지 접속

시그널 뷰어 페이지에서 다음을 볼 수 있습니다:
- **최신 결과 섹션**: 가장 최근의 백테스트 결과
- **고급 필터 섹션**: 히스토리 검색 및 필터링 (Task 3.3-3)
- **히스토리 섹션**: 과거 백테스트 실행 기록

### 2단계: 최신 결과 확인

최신 결과 카드에서 다음 정보를 확인할 수 있습니다:
- 실행 ID (run_id)
- 사용된 전략
- 백테스트 기간
- 타임프레임
- 신호 수
- 실행 소요 시간

---

## 심볼 활성화 관리 (Phase 2 새 기능)

### 심볼 토글 인터페이스

**위치**: 최신 결과 카드의 "심볼 활성화 관리" 섹션

#### 기본 사용법

1. **활성/비활성 토글**
   - 각 심볼 옆의 체크박스를 클릭하여 활성화/비활성화
   - 활성 심볼: ✓ 체크됨, 녹색 배지 "활성"
   - 비활성 심볼: ☐ 체크 해제됨, 빨간색 배지 "비활성"

2. **상태 표시**
   - 상단의 "활성 수 / 전체 수"를 통해 활성 심볼 개수 확인
   - 토글 진행 중: 스피너 표시

3. **신호 정보**
   - 각 심볼의 신호 수 표시
   - 기본값으로 모든 심볼이 활성화되어 있음

#### 예시

```
심볼 활성화 관리                          3/4 활성

☑ BTC_KRW      활성    100 신호
☑ ETH_KRW      활성     50 신호
☑ XRP_KRW      활성     30 신호
☐ DOGE_KRW     비활성   20 신호
```

### 성과 분석에 반영

토글 변경 후:
1. **활성 심볼만** 심볼별 성과 카드에 표시됨
2. **비활성 심볼**은 자동으로 숨겨짐
3. **알림 메시지**: "X개의 비활성 심볼은 성과 분석에서 제외되었습니다."

#### 예시: 심볼별 성과 섹션

토글 전:
```
심볼별 성과
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ BTC_KRW │ │ ETH_KRW │ │ XRP_KRW │ │DOGE_KRW │
│ 신호: 10│ │ 신호: 5 │ │ 신호: 3 │ │신호: 2 │
└─────────┘ └─────────┘ └─────────┘ └─────────┘
```

토글 후 (DOGE_KRW 비활성화):
```
심볼별 성과 (3/4 활성)
┌─────────┐ ┌─────────┐ ┌─────────┐
│ BTC_KRW │ │ ETH_KRW │ │ XRP_KRW │
│ 신호: 10│ │ 신호: 5 │ │ 신호: 3 │
└─────────┘ └─────────┘ └─────────┘

ℹ️ 1개의 비활성 심볼은 성과 분석에서 제외되었습니다.
```

---

## 고급 필터링 (Task 3.3-3)

### 필터 패널

고급 필터 섹션에서 다음 조건으로 히스토리를 검색할 수 있습니다:

| 필터 | 설명 |
|------|------|
| **전략** | 특정 전략만 조회 |
| **수익률 범위** | 최소~최대 평균 수익률 (%) |
| **신호 범위** | 최소~최대 신호 개수 |
| **기간 범위** | 시작일~종료일 사이의 결과 |

### 필터 사용 예제

**예**: 1% 이상의 수익을 기록한 volume_zone_breakout 전략 결과 조회

```
전략 선택:      volume_zone_breakout
수익률 범위:    1.0 ~ 10.0
신호 범위:      (공백 = 제한 없음)
기간 범위:      (공백 = 제한 없음)

[필터 적용] [초기화]
```

---

## 히스토리 관리

### 페이지네이션

히스토리 테이블 아래의 페이지네이션 컨트롤:
- **이전**: 이전 페이지로 이동
- **다음**: 다음 페이지로 이동
- **현재 페이지**: "1 / 5 (총 45개)" 형식

### 행 클릭 시 신호 상세 보기

1. 히스토리 테이블의 행을 클릭
2. 해당 실행의 심볼별 신호 목록 표시
3. 신호 테이블에서 개별 신호의 진입/청산 가격 확인

### 결과 다운로드

각 결과 행의 액션 버튼:
- **JSON**: JSON 형식으로 전체 결과 다운로드
- **CSV**: CSV 형식으로 신호 목록 다운로드

---

## 결과 비교 (Phase 2)

### 비교 선택 및 실행

1. **비교할 항목 선택**: 히스토리 테이블의 체크박스 (최대 3개)
2. **비교하기 버튼 클릭**: "📊 비교하기" 버튼 활성화
3. **비교 결과 모달**: 선택한 결과들의 메트릭 비교

### 비교 항목

- 전략 및 파라미터
- 백테스트 기간
- 신호 수
- 심볼별 성과 (승률, 평균 수익률, 최대 낙폭)
- 실행 시간

---

## 문제 해결

### Q1: 토글이 동작하지 않습니다

**확인 사항**:

1. **네트워크 연결 확인**
   - 브라우저 개발자 도구 (F12) → 네트워크 탭 확인
   - PATCH 요청이 200 OK를 반환하는지 확인

2. **브라우저 콘솔 에러 확인**
   - F12 → 콘솔 탭
   - 빨간색 에러 메시지 확인 및 캡처

3. **서버 상태 확인**
   - 서버가 실행 중인지 확인
   - 서버 로그에서 에러 메시지 확인

**해결 방법**:
- 페이지 새로고침 (Ctrl+F5 또는 Cmd+Shift+R)
- 브라우저 캐시 삭제
- 로컬 스토리지 삭제: DevTools → Application → Local Storage → 사이트 삭제

### Q2: 변경사항이 저장되지 않습니다

**확인 사항**:

1. **응답 상태 코드**
   - 200 OK가 아닌 다른 상태 코드?
   - 404: run_id 또는 symbol이 존재하지 않음
   - 500: 서버 저장 오류

2. **UI 반영 지연**
   - 토글 후 2-3초 대기
   - 스피너가 사라질 때까지 기다리기

3. **페이지 새로고침**
   - F5로 페이지 새로고침하여 최신 상태 확인

**해결 방법**:
- 브라우저 개발자 도구에서 네트워크 요청 확인
- 서버 로그에서 저장 오류 확인
- 필요시 관리자에게 문의

### Q3: "비활성 심볼은 성과 분석에서 제외되었습니다" 메시지가 계속 나타납니다

**정상 동작입니다**. 이 메시지는:
- 하나 이상의 심볼이 비활성화되어 있음
- 성과 분석에는 활성 심볼만 포함됨
- 메시지는 비활성 심볼의 개수를 알려줌

비활성 심볼을 제거하려면:
- 비활성 심볼의 체크박스 클릭하여 다시 활성화

### Q4: 레거시 결과는 어떻게 처리되나요?

**자동 호환성 지원**:
- 이전 버전에서 생성된 결과(is_active 필드 없음)도 자동으로 처리됨
- 기본값으로 모든 심볼이 활성화됨
- 토글하여 비활성화 가능

---

## 팁 & 트릭

### 1. 특정 심볼만 분석하기

**시나리오**: BTC_KRW만의 성과를 보고 싶음

1. BTC_KRW 제외 모든 심볼 체크박스 클릭 → 비활성화
2. 성과 분석에서 BTC_KRW만 표시됨
3. 신호 테이블에서 상세 신호 확인

### 2. 여러 결과 비교하기

**시나리오**: 같은 기간의 두 전략 비교

1. 전략 A 결과 행의 체크박스 클릭
2. 전략 B 결과 행의 체크박스 클릭
3. "📊 비교하기" 클릭
4. 모달에서 전략별 성과 비교

### 3. 수익성 높은 결과 찾기

**고급 필터 사용**:
1. "수익률 범위" → 최소: 2.0, 최대: 10.0 (2% 이상)
2. "신호 범위" → 최소: 50 (신호가 충분한 결과)
3. 필터 적용
4. 조건을 만족하는 결과만 표시

### 4. 백테스트 결과 아카이빙

**CSV 다운로드**:
1. 결과 행의 "CSV" 버튼 클릭
2. 신호 목록이 CSV로 다운로드됨
3. Excel 등에서 분석 가능

---

## 성능 최적화

### 대용량 데이터 조회 시

- **페이지 크기 제한**: 한 페이지당 10개 항목 (고정)
- **고급 필터 사용**: 조건을 좁혀서 검색 속도 향상
- **캐시 활용**: 최신 결과는 5초 간격으로 자동 갱신

### 많은 심볼의 토글 시

- 토글 요청은 각각 처리됨 (순차적)
- 네트워크 지연이 있으면 1-2초 소요 가능
- 여러 심볼을 토글할 때는 각각 응답 대기

---

## 알려진 제한사항

### Phase 2 현황

| 기능 | 상태 | 계획 |
|------|------|------|
| 심볼별 활성/비활성 토글 | ✅ 구현 | Phase 2 완료 |
| 활성 심볼만 성과 표시 | ✅ 구현 | Phase 2 완료 |
| 일괄 토글 (전체 활성/비활성) | 🔄 계획 | Phase 3 |
| 전역 활성 심볼 설정 | 🔄 계획 | Phase 3 |
| E2E 자동화 테스트 | 🔄 계획 | Phase 3+ |

---

## 다음 단계

### Phase 3 예정 기능

1. **일괄 토글 기능**
   - "모두 활성화" / "모두 비활성화" 버튼

2. **전역 활성 심볼 설정**
   - 새 백테스트 실행 시 기본 활성 심볼 설정

3. **저장된 필터 프리셋**
   - 자주 사용하는 필터 조합 저장

4. **E2E 자동화**
   - Playwright/Selenium 기반 사용자 시나리오 검증

---

## 추가 리소스

- [심볼 토글 API 명세](./SYMBOL_TOGGLE_API.md)
- [API 스펙](./api_spec.md)
- [Phase 2 구현 가이드](./phase2_plan.md)
- [Issue #35](https://github.com/[repo]/issues/35)

---

## 피드백 & 문의

이슈나 피드백이 있으시면:
- GitHub Issues에서 새 이슈 생성
- 기술 문의: 팀 Slack 채널
- 버그 보고: GitHub Issues (template: Bug Report)

감사합니다! 🙏
